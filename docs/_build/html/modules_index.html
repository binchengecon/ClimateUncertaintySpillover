
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Modules: &#8212; UncertaintySpillover  documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/material.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="References" href="bib_file.html" />
    <link rel="prev" title="A. Complete model" href="app/appendices.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue-grey data-md-color-accent=light-blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#modules_index" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="index.html" title="UncertaintySpillover  documentation"
           class="md-header-nav__button md-logo">
          
            <i class="md-icon">&#xe55d</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">UncertaintySpillover</span>
          <span class="md-header-nav__topic"> Modules: </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/lphansen/WrestlingClimate" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Uncertainty Spillover
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = ""versions.json"",
        target_loc = "../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">UncertaintySpillover  documentation</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="index.html" title="UncertaintySpillover documentation" class="md-nav__button md-logo">
      
        <i class="md-icon">&#xe55d</i>
      
    </a>
    <a href="index.html"
       title="UncertaintySpillover documentation">UncertaintySpillover</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/lphansen/WrestlingClimate" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Uncertainty Spillover
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Contents:</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="sec1/sec1_Introduction.html" class="md-nav__link">1 Introduction</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="sec2/sec2_UncertainClimateDynamics.html" class="md-nav__link">2 Uncertain climate dynamics</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="sec3/sec3_StochasticDamage.html" class="md-nav__link">3 A stochastic model of damages</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="sec4/sec4_IllustrativeEcon.html" class="md-nav__link">4 Illustrative Economy</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="sec5/sec5_UncertaintyAversion.html" class="md-nav__link">5 Uncertainty aversion</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="sec6/sec6_DecisionProblem.html" class="md-nav__link">6 A climate component of a planner’s decision problem</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="sec7/sec7_Sensitivity.html" class="md-nav__link">7 Sensitivity</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="sec8/sec8_UncertaintyDecomposition.html" class="md-nav__link">8 Uncertainty Decomposition</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="sec10/sec10_Conclusion.html" class="md-nav__link">10 Conclusion</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="app/appendices.html" class="md-nav__link">A. Complete model</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="app/appendices.html#b-computation-methods" class="md-nav__link">B. Computation methods</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Modules: </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Modules:</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#modules-index--page-root" class="md-nav__link">Modules:</a>
        </li>
        <li class="md-nav__item"><a href="#module-source.model" class="md-nav__link">1 model</a>
        </li>
        <li class="md-nav__item"><a href="#module-source.simulation" class="md-nav__link">2 simulation</a>
        </li>
        <li class="md-nav__item"><a href="#module-source.solver" class="md-nav__link">3 solver</a>
        </li>
        <li class="md-nav__item"><a href="#module-source.utilities" class="md-nav__link">4 utilities</a>
        </li>
  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#module-source.model" class="md-nav__link">1 model</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#module-source.simulation" class="md-nav__link">2 simulation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#module-source.solver" class="md-nav__link">3 solver</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#module-source.utilities" class="md-nav__link">4 utilities</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="bib_file.html" class="md-nav__link">References</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#modules-index--page-root" class="md-nav__link">Modules:</a>
        </li>
        <li class="md-nav__item"><a href="#module-source.model" class="md-nav__link">1 model</a>
        </li>
        <li class="md-nav__item"><a href="#module-source.simulation" class="md-nav__link">2 simulation</a>
        </li>
        <li class="md-nav__item"><a href="#module-source.solver" class="md-nav__link">3 solver</a>
        </li>
        <li class="md-nav__item"><a href="#module-source.utilities" class="md-nav__link">4 utilities</a>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<h1 id="modules-index--page-root">Modules:<a class="headerlink" href="#modules-index--page-root" title="Permalink to this headline">¶</a></h1>
<p>The module <code class="docutils literal notranslate"><span class="pre">source</span></code> includes functions used for solving ODEs and simulating trajectories of the project.</p>
<span class="target" id="module-source"></span>

<span id="model"></span><h1 id="module-source.model">1 model<a class="headerlink" href="#module-source.model" title="Permalink to this headline">¶</a></h1>
<p>Functions that solve the HJBs in the draft paper.</p>
<dl class="py function">
<dt id="source.model.solve_hjb_y">
<code class="sig-prename descclassname"><span class="pre">source.model.</span></code><code class="sig-name descname"><span class="pre">solve_hjb_y</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ε</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_iteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#source.model.solve_hjb_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the HJB that is only related to y.
y is the accumulative change of temperature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ndarray</em>) – An evenly spaced grid of y.</p></li>
<li><p><strong>model_args</strong> (<em>tuple of model inputs:</em>) – <p>The first 9 elements are floats for <span class="math notranslate nohighlight">\(η, δ, σ_y, \bar{y}, γ_1, γ_2, γ_3, ξ_w, ξ_a\)</span>.</p>
<p>The last two are (L,) ndarrays for <span class="math notranslate nohighlight">\(\{θ_\ell\}_{\ell=1}^L, \{\pi^a_\ell\}_{\ell=1}^L\)</span>.</p>
</p></li>
<li><p><strong>v0</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ndarray</em><em>, </em><em>default=None</em>) – Initial guess of the value function</p></li>
<li><p><strong>ϵ</strong> (<em>float</em>) – Step size of the false transient method.</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – Tolerance level of the hjb solver.</p></li>
<li><p><strong>max_iter</strong> (<em>int</em>) – Maximum iterations of the false transient method.</p></li>
<li><p><strong>print_iteration</strong> (<em>bool</em>) – Print the information of each iteration if True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>res</strong> –</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">dict</span></code>: {</dt><dd><dl class="simple">
<dt>v<span class="classifier">(N,) ndarray</span></dt><dd><p>Value function, <span class="math notranslate nohighlight">\(\phi(y)\)</span>.</p>
</dd>
<dt>dvdy<span class="classifier">(N,) ndarray</span></dt><dd><p>First order derivative of the value function, <span class="math notranslate nohighlight">\(\frac{d\phi(y)}{dy}\)</span>.</p>
</dd>
<dt>dvddy<span class="classifier">(N,) ndarray</span></dt><dd><p>Second order derivative of the value function, <span class="math notranslate nohighlight">\(\frac{d^2\phi(y)}{dy^2}\)</span>.</p>
</dd>
<dt>e_tilde<span class="classifier">(N,) ndarray</span></dt><dd><p><span class="math notranslate nohighlight">\(\tilde{e}\)</span> on the grid of y.</p>
</dd>
<dt>πc<span class="classifier">(M, N) ndarray</span></dt><dd><p>Distorted probabilities of <span class="math notranslate nohighlight">\(\{θ_\ell\}_{\ell=1}^L\)</span>.</p>
</dd>
<dt>h<span class="classifier">(N,) ndarray</span></dt><dd><p>Implied drift distortion.</p>
</dd>
<dt>y<span class="classifier">(N,) ndarray</span></dt><dd><p>Grid of y.</p>
</dd>
<dt>model_args<span class="classifier">tuple</span></dt><dd><p>Model parameters, see model_args above in <cite>Parameters</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<p>}</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict of ndarrays</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="source.model.solve_hjb_y_jump">
<code class="sig-prename descclassname"><span class="pre">source.model.</span></code><code class="sig-name descname"><span class="pre">solve_hjb_y_jump</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ε</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_iteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#source.model.solve_hjb_y_jump" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the HJB with y prior to jump. We impose certainty equivalent as a boundary condition
to the equation instead of adding the jump intensity term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ndarray</em>) – An evenly spaced grid of y.</p></li>
<li><p><strong>model_args</strong> (<em>tuple of model inputs:</em>) – <p>The ten float elements are for <span class="math notranslate nohighlight">\(η, δ, σ_y, \bar{y}, γ_1, γ_2, γ_3, ξ_w, ξ_p, ξ_a\)</span>;</p>
<p>Two <cite>(L,) ndarrays</cite> are for <span class="math notranslate nohighlight">\(\{θ_\ell\}_{\ell=1}^L\)</span>, <span class="math notranslate nohighlight">\(\{\pi^a_\ell\}_{\ell=1}^L\)</span>;</p>
<p>Two <cite>(M,N) ndarrays</cite> are  for <span class="math notranslate nohighlight">\(\{\phi_m(y)\}_{m=1}^M\)</span>, <span class="math notranslate nohighlight">\(\{\pi_p^m\}_{m=1}^M\)</span>.</p>
</p></li>
<li><p><strong>v0</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ndarray</em>) – Initial guess of the value function</p></li>
<li><p><strong>ϵ</strong> (<em>float</em>) – Step size of the false transient method.</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – Tolerance level of the hjb solver.</p></li>
<li><p><strong>max_iter</strong> (<em>int</em>) – Maximum iterations of the false transient method.</p></li>
<li><p><strong>print_iteration</strong> (<em>bool</em>) – Print the information of each iteration if True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>res</strong> –</p>
<dl class="simple">
<dt>dict: {</dt><dd><dl class="simple">
<dt>v: (N,) ndarray</dt><dd><p>Value function <span class="math notranslate nohighlight">\(\phi(y)\)</span></p>
</dd>
<dt>dvdy: (N,) ndarray</dt><dd><p>First order derivative of the value function, <span class="math notranslate nohighlight">\(\frac{d\phi(y)}{dy}\)</span></p>
</dd>
<dt>dvddy: (N,) ndarray</dt><dd><p>Second order derivative of the value function.</p>
</dd>
<dt>e_tilde<span class="classifier">(N,) ndarray</span></dt><dd><p><span class="math notranslate nohighlight">\(\tilde{e}\)</span> on the grid of y.</p>
</dd>
<dt>h<span class="classifier">(N,) ndarray</span></dt><dd><p>Implied drift distortion.</p>
</dd>
<dt>πc<span class="classifier">(M, N) ndarray</span></dt><dd><p>Distorted probabilities of θ.</p>
</dd>
<dt>g<span class="classifier">(K, N) ndarray</span></dt><dd><p>Change in damage probability and intensity.</p>
</dd>
<dt>πd<span class="classifier">(K, N) ndarray</span></dt><dd><p>Distorted probabilities of damage functions.</p>
</dd>
<dt>bc<span class="classifier">float</span></dt><dd><p>The boundary condition that we impose on the HJB.</p>
</dd>
<dt>y<span class="classifier">(N,) ndarray</span></dt><dd><p>Grid of y.</p>
</dd>
<dt>model_args<span class="classifier">tuple</span></dt><dd><p>Model parameters.</p>
</dd>
</dl>
</dd>
</dl>
<p>}</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict of ndarrays</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="source.model.solve_hjb_z">
<code class="sig-prename descclassname"><span class="pre">source.model.</span></code><code class="sig-name descname"><span class="pre">solve_hjb_z</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ε</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_iteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#source.model.solve_hjb_z" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the HJB that is only related to z.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ndarray</em>) – An evenly spaced grid of z.</p></li>
<li><p><strong>model_args</strong> (<em>tuple of model inputs</em>) – Elements are floats for <span class="math notranslate nohighlight">\(η, δ, ρ, μ_2, σ_2, ξ_{1m}\)</span> in the HJB.</p></li>
<li><p><strong>v0</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ndarray</em>) – Initial guess of the value function</p></li>
<li><p><strong>ϵ</strong> (<em>float</em>) – Step size of the false transient method.</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – Tolerance level of the hjb solver.</p></li>
<li><p><strong>max_iter</strong> (<em>int</em>) – Maximum iterations of the false transient method.</p></li>
<li><p><strong>print_iteration</strong> (<em>bool</em>) – Print the information of each iteration if True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>res</strong> –</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">dict</span></code>: {</dt><dd><dl class="simple">
<dt>v<span class="classifier">(N,) ndarray</span></dt><dd><p>Value function, <span class="math notranslate nohighlight">\(\zeta(z)\)</span>.</p>
</dd>
<dt>dvdz<span class="classifier">(N,) ndarray</span></dt><dd><p>First order derivative of the value function, <span class="math notranslate nohighlight">\(\frac{\partial\zeta(z)}{\partial z}\)</span>.</p>
</dd>
<dt>dvddz<span class="classifier">(N,) ndarray</span></dt><dd><p>Second order derivative of the value function, <span class="math notranslate nohighlight">\(\frac{\partial^2\zeta(z)}{\partial z\partial z'}\)</span>.</p>
</dd>
<dt>h<span class="classifier">(N,) ndarray</span></dt><dd><p>Implied drift distortion.</p>
</dd>
<dt>z<span class="classifier">(N,) ndarray</span></dt><dd><p>Grid of z.</p>
</dd>
<dt>model_args<span class="classifier">tuple</span></dt><dd><p>Model parameters.</p>
</dd>
</dl>
</dd>
</dl>
<p>}</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict of ndarrays</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="source.model.uncertainty_decomposition">
<code class="sig-prename descclassname"><span class="pre">source.model.</span></code><code class="sig-name descname"><span class="pre">uncertainty_decomposition</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_tilde</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">πc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ε</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_iteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#source.model.uncertainty_decomposition" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the PDE with a given <span class="math notranslate nohighlight">\(\tilde{e}\)</span>. If h is not given, minimize over h; if πc is not given,
minimize over πc; if <code class="docutils literal notranslate"><span class="pre">bc</span></code> is not given, use certainty equivalent as <code class="docutils literal notranslate"><span class="pre">bc</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>(</em><em>N</em><em>, </em><em>) </em><em>array</em>) – Grid of y, <span class="math notranslate nohighlight">\(y \in [0, \bar{y}]\)</span>.</p></li>
<li><p><strong>model_args</strong> (<em>tuple of model inputs</em>) – same as <code class="docutils literal notranslate"><span class="pre">model_args</span></code> in  <a class="reference internal" href="#source.model.solve_hjb_y_jump" title="source.model.solve_hjb_y_jump"><code class="xref py py-func docutils literal notranslate"><span class="pre">solve_hjb_y_jump()</span></code></a>.</p></li>
<li><p><strong>e_tilde</strong> (<em>(</em><em>N</em><em>, </em><em>) </em><em>array</em><em>, </em><em>default=None</em>) – <span class="math notranslate nohighlight">\(\tilde{e}\)</span> solution from the HJB with full uncertainty configuration.</p></li>
<li><p><strong>h</strong> (<em>(</em><em>N</em><em>, </em><em>) </em><em>array</em><em>, </em><em>default=None:</em>) – Drift distortion. To consider baseline brownian misspecification, assign <cite>np.zeros_like(y)</cite>.</p></li>
<li><p><strong>πc</strong> (<em>(</em><em>L</em><em>, </em><em>N</em><em>) </em><em>array</em><em>, </em><em>default=None:</em>) – Distorted probabilities of <span class="math notranslate nohighlight">\(\{\omega_\ell\}_{\ell=1}^L\)</span>. To consider baseline smooth ambiguity,
assign equal weight to coefficients for evey point of y.</p></li>
<li><p><strong>bc</strong> (<em>tuple</em><em>, </em><em>default=None</em>) – Boundary condition.</p></li>
<li><p><strong>v0</strong> (<em>(</em><em>N</em><em>, </em><em>) </em><em>array</em><em>, </em><em>default=None</em>) – Initial guess.</p></li>
<li><p><strong>ϵ</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Step size.</p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>default=1e-8</em>) – Tolerance level.</p></li>
<li><p><strong>max_iter</strong> (<em>int</em><em>, </em><em>default=10</em><em>,</em><em>000</em>) – Maximum iterations of false transient method.</p></li>
<li><p><strong>print_iteration</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Print the information of each iteration if <cite>True</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>res</strong> –</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">dict</span></code>: {</dt><dd><dl class="simple">
<dt>v<span class="classifier">(N, ) ndarrays</span></dt><dd><p>Solution of value function for uncertainty decomposition.</p>
</dd>
<dt>dvdy<span class="classifier">(N, ) ndarrays</span></dt><dd><p>First order derivatives</p>
</dd>
<dt>dvddy<span class="classifier">(N, ) ndarrays</span></dt><dd><p>Second order derivatives</p>
</dd>
<dt>y<span class="classifier">(N, ) ndarray</span></dt><dd><p>Grid of y</p>
</dd>
<dt>ME<span class="classifier">(N, ) ndarray</span></dt><dd><p>Marginal value of emission.Computed according to () in</p>
</dd>
</dl>
</dd>
</dl>
<p>}</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict of ndarrays</p>
</dd>
</dl>
</dd></dl>


<span id="simulation"></span><h1 id="module-source.simulation">2 simulation<a class="headerlink" href="#module-source.simulation" title="Permalink to this headline">¶</a></h1>
<p>module for simulation</p>
<dl class="py function">
<dt id="source.simulation.simulate_jump">
<code class="sig-prename descclassname"><span class="pre">source.simulation.</span></code><code class="sig-name descname"><span class="pre">simulate_jump</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">θ_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ME</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#source.simulation.simulate_jump" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate temperature anomaly, emission, distorted probabilities of climate models,
distorted probabilities of damage functions, and drift distortion.
When ME is asigned value, it will also simulate paths for marginal value of emission</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_res</strong> (<em>dict</em>) – A dictionary storing solution with misspecified jump process.
See <a class="reference internal" href="#source.model.solve_hjb_y_jump" title="source.model.solve_hjb_y_jump"><code class="xref py py-func docutils literal notranslate"><span class="pre">solve_hjb_y_jump()</span></code></a> for detail.</p></li>
<li><p><strong>θ_list</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ndarray:</em>) – A list of matthew coefficients. Unit: celsius/gigaton of carbon.</p></li>
<li><p><strong>ME</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ndarray</em>) – Marginal value of emission as a function of y.</p></li>
<li><p><strong>y_start</strong> (<em>float</em><em>, </em><em>default=1</em>) – Initial value of y.</p></li>
<li><p><strong>T</strong> (<em>int</em><em>, </em><em>default=100</em>) – Time span of simulation.</p></li>
<li><p><strong>dt</strong> (<em>float</em><em>, </em><em>default=1</em>) – Time interval of simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>simulation_res</strong> –</p>
<dl class="simple">
<dt>dict: {</dt><dd><dl class="simple">
<dt>yt<span class="classifier">(T,) ndarray</span></dt><dd><p>Temperature anomaly trajectories.</p>
</dd>
<dt>et<span class="classifier">(T,) ndarray</span></dt><dd><p>Emission trajectories.</p>
</dd>
<dt>πct<span class="classifier">(T, L) ndarray</span></dt><dd><p>Trajectories for distorted probabilities of climate models.</p>
</dd>
<dt>πdt<span class="classifier">(T, M) ndarray</span></dt><dd><p>Trajectories for distorted probabilities of damage functions.</p>
</dd>
<dt>ht<span class="classifier">(T,) ndarray</span></dt><dd><p>Trajectories for drift distortion.</p>
</dd>
<dt>if ME is not None, the dictionary will also include</dt><dd><dl class="simple">
<dt>me_t<span class="classifier">(T,) ndarray</span></dt><dd><p>Trajectories for marginal value of emission.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p>}</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict of ndarrays</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="source.simulation.simulate_me">
<code class="sig-prename descclassname"><span class="pre">source.simulation.</span></code><code class="sig-name descname"><span class="pre">simulate_me</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">θ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.00186</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#source.simulation.simulate_me" title="Permalink to this definition">¶</a></dt>
<dd><p>simulate trajectories of uncertainty decomposition</p>
<div class="math notranslate nohighlight">
\[\log(\frac{ME_{new}}{ME_{baseline}})\times 1000.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_grid</strong> (<em>(</em><em>N</em><em>, </em><em>) </em><em>ndarray</em>) – Grid of y.</p></li>
<li><p><strong>e_grid</strong> (<em>(</em><em>N</em><em>, </em><em>) </em><em>ndarray</em>) – Corresponding <span class="math notranslate nohighlight">\(\tilde{e}\)</span> on the grid of y.</p></li>
<li><p><strong>ratio_grid</strong> (<em>(</em><em>N</em><em>, </em><em>) </em><em>ndarray:</em>) – Corresponding <span class="math notranslate nohighlight">\(\log(\frac{ME_{new}}{ME_{baseline}})\times 1000\)</span> on the grid of y.</p></li>
<li><p><strong>θ</strong> (<em>float</em><em>, </em><em>default=1.86/1000</em>) – Coefficient used for simulation.</p></li>
<li><p><strong>y_start</strong> (<em>float</em>) – Initial value of y.</p></li>
<li><p><strong>T</strong> (<em>int</em><em>, </em><em>default=100</em>) – Time span of simulation.</p></li>
<li><p><strong>dt</strong> (<em>float</em><em>, </em><em>default=1</em>) – Time interval of simulation. Default=1 indicates yearly simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>Et</strong> (<em>(T, ) ndarray</em>) – Emission trajectory.</p></li>
<li><p><strong>yt</strong> (<em>(T, ) ndarray</em>) – Temperature anomaly trajectories.</p></li>
<li><p><strong>ratio_t</strong> (<em>(T, ) ndarray</em>) – Uncertainty decomposition ratio trajectories.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>


<span id="solver"></span><h1 id="module-source.solver">3 solver<a class="headerlink" href="#module-source.solver" title="Permalink to this headline">¶</a></h1>
<p>Functions to numerically solve a nonlinear ODE via false transient scheme.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>For more details on false transient:
refer to <span class="xref std std-doc">~app.appendices</span> (TODO:fix to ref).</p>
</div>
<p>The ODE we solve is as follows:</p>
<p>The state space descretize into <span class="math notranslate nohighlight">\(y_1, y_2, \dots, y_N\)</span> with equal interval <span class="math notranslate nohighlight">\(\Delta y\)</span>.
For each <span class="math notranslate nohighlight">\(y_n \in \{y_1, y_2, \dots, y_N\}\)</span> in the grid with , the value function satifies
(we use upwinding first order derivative for concern of,
and at <span class="math notranslate nohighlight">\(y_1\)</span> we use forward derivative instead):</p>
<div class="math notranslate nohighlight" id="equation-ode">
<span class="eqno">(1)<a class="headerlink" href="#equation-ode" title="Permalink to this equation">¶</a></span>\[\begin{align}
\frac{\phi_{i+1}(y_n) - \phi_{i}(y)}{\epsilon} =&amp; \quad A_n \phi_{i+1}(y) \cr
&amp; + B_{n} \frac{\phi_{i+1}(y_n) - \phi_{i+1}(y_{n-1})}{\Delta y}  \cr
&amp; + C_n \frac{\phi_{i+1}(y_{n+1}) - 2 \phi_{i+1}(y_{n}) + \phi_{i+1}(y_{n-1})}{\Delta y^2} \cr
&amp; + D_n
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(A_n\)</span>, <span class="math notranslate nohighlight">\(B_n\)</span>, <span class="math notranslate nohighlight">\(C_n\)</span> and <span class="math notranslate nohighlight">\(D_n\)</span> are coefficients.
The exact values are given by the HJB to be solved.
Therefore, we construct the following linear system:</p>
<div class="math notranslate nohighlight" id="equation-ft">
<span class="eqno">(2)<a class="headerlink" href="#equation-ft" title="Permalink to this equation">¶</a></span>\[LHS \cdot \phi_{i+1}(Y) = - D - \frac{1}{\epsilon} \phi_{i}(Y)\]</div>
<p>where <span class="math notranslate nohighlight">\(LHS\)</span> is a <span class="math notranslate nohighlight">\(N\times N\)</span> matrix of coefficients, <span class="math notranslate nohighlight">\(Y = (y_1, y_2, \dots, y_N)'\)</span>,
and <span class="math notranslate nohighlight">\(D = (D_1, D_2, \dots, D_n)'\)</span>.</p>
<dl class="py function">
<dt id="source.solver.compute_coefficient">
<code class="sig-prename descclassname"><span class="pre">source.solver.</span></code><code class="sig-name descname"><span class="pre">compute_coefficient</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">LHS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ε</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#source.solver.compute_coefficient" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the coefficient of the equation at <span class="math notranslate nohighlight">\(y_i\)</span>.
Values are computed according to <a class="reference internal" href="#equation-ode">(1)</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>LHS</strong> (<em>(</em><em>I</em><em>, </em><em>I</em><em>) </em><em>ndarray</em>) – LHS matrix of the linear system.</p></li>
<li><p><strong>A</strong> (<em>(</em><em>I</em><em>,</em><em>) </em><em>ndarrays</em>) – Coefficient arrays for value function <span class="math notranslate nohighlight">\(\phi(y_i)\)</span>.</p></li>
<li><p><strong>B</strong> (<em>(</em><em>I</em><em>,</em><em>) </em><em>ndarrays</em>) – Coefficient arrays for first order derivative.</p></li>
<li><p><strong>C</strong> (<em>(</em><em>I</em><em>,</em><em>) </em><em>ndarrays</em>) – Coefficient arrays for second order derivative.</p></li>
<li><p><strong>i</strong> (<em>int</em>) – Index for the grid point.</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – Grid step, <span class="math notranslate nohighlight">\(\Delta y\)</span>.</p></li>
<li><p><strong>ϵ</strong> (<em>float</em>) – False transient step size.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>LHS</strong> – Updated LHS matrix of the linear system.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(I, I) ndarray</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="source.solver.false_transient">
<code class="sig-prename descclassname"><span class="pre">source.solver.</span></code><code class="sig-name descname"><span class="pre">false_transient</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ε</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">impose_bc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#source.solver.false_transient" title="Permalink to this definition">¶</a></dt>
<dd><p>Implement false transient scheme of one iteration,
and update from <span class="math notranslate nohighlight">\(\phi_i(y)\)</span> to <span class="math notranslate nohighlight">\(\phi_{i+1}(y)\)</span>
according to <a class="reference internal" href="#equation-ft">(2)</a>.</p>
<p>See appendix B(TODO: cross-ref link) for further detail.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> – Same as those in <a class="reference internal" href="#source.solver.compute_coefficient" title="source.solver.compute_coefficient"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_coefficient()</span></code></a></p></li>
<li><p><strong>B</strong> – Same as those in <a class="reference internal" href="#source.solver.compute_coefficient" title="source.solver.compute_coefficient"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_coefficient()</span></code></a></p></li>
<li><p><strong>C</strong> – Same as those in <a class="reference internal" href="#source.solver.compute_coefficient" title="source.solver.compute_coefficient"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_coefficient()</span></code></a></p></li>
<li><p><strong>D</strong> – Same as those in <a class="reference internal" href="#source.solver.compute_coefficient" title="source.solver.compute_coefficient"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_coefficient()</span></code></a></p></li>
<li><p><strong>v0</strong> (<em>(</em><em>I</em><em>, </em><em>) </em><em>ndarrays</em>) – Value function from last iteration, <span class="math notranslate nohighlight">\(\phi_i(y)\)</span></p></li>
<li><p><strong>ϵ</strong> (<em>float</em>) – Step size of false transient</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – Step size of Grid</p></li>
<li><p><strong>bc</strong> – See <a class="reference internal" href="#source.solver.linearize" title="source.solver.linearize"><code class="xref py py-func docutils literal notranslate"><span class="pre">linearize()</span></code></a>.</p></li>
<li><p><strong>impose_bc</strong> – See <a class="reference internal" href="#source.solver.linearize" title="source.solver.linearize"><code class="xref py py-func docutils literal notranslate"><span class="pre">linearize()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>v</strong> – Updated value function, <span class="math notranslate nohighlight">\(\phi_{i+1}(y)\)</span> according to <a class="reference internal" href="#equation-ft">(2)</a>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(I, ) ndarrays</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="source.solver.linearize">
<code class="sig-prename descclassname"><span class="pre">source.solver.</span></code><code class="sig-name descname"><span class="pre">linearize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ε</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">impose_bc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#source.solver.linearize" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct coefficient matrix of the linear system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>(</em><em>I</em><em>,</em><em>) </em><em>ndarrays</em>) – see <a class="reference internal" href="#source.solver.compute_coefficient" title="source.solver.compute_coefficient"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_coefficient()</span></code></a> for further detail.</p></li>
<li><p><strong>B</strong> (<em>(</em><em>I</em><em>,</em><em>) </em><em>ndarrays</em>) – see <a class="reference internal" href="#source.solver.compute_coefficient" title="source.solver.compute_coefficient"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_coefficient()</span></code></a> for further detail.</p></li>
<li><p><strong>C</strong> (<em>(</em><em>I</em><em>,</em><em>) </em><em>ndarrays</em>) – see <a class="reference internal" href="#source.solver.compute_coefficient" title="source.solver.compute_coefficient"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_coefficient()</span></code></a> for further detail.</p></li>
<li><p><strong>D</strong> (<em>(</em><em>I</em><em>,</em><em>) </em><em>ndarrays</em>) – see <a class="reference internal" href="#source.solver.compute_coefficient" title="source.solver.compute_coefficient"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_coefficient()</span></code></a> for further detail.</p></li>
<li><p><strong>v0</strong> (<em>(</em><em>I</em><em>,</em><em>) </em><em>ndarray</em>) – Value function from last iteration, <span class="math notranslate nohighlight">\(\phi_i(y)\)</span>.</p></li>
<li><p><strong>ϵ</strong> (<em>float</em>) – False transient step size.</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – Grid step size.</p></li>
<li><p><strong>bc</strong> (<em>tuple of ndarrays:</em>) – <p>Impose <cite>v=bc[k]</cite> at boundaries.</p>
<p>Order: lower boundary of x, upper boundary of x,</p>
</p></li>
<li><p><strong>impose_bc</strong> (<em>tuple of bools</em>) – Order: lower boundary of x, upper boundary of x,</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>LHS</strong> (<em>(I, I) ndarray</em>) – LHS of the linear system.</p></li>
<li><p><strong>RHS</strong> (<em>(I,) ndarray</em>) – RHS of the linear system.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>


<span id="utilities"></span><h1 id="module-source.utilities">4 utilities<a class="headerlink" href="#module-source.utilities" title="Permalink to this headline">¶</a></h1>
<p>Functions that facilitate computation.</p>
<dl class="py function">
<dt id="source.utilities.compute_derivatives">
<code class="sig-prename descclassname"><span class="pre">source.utilities.</span></code><code class="sig-name descname"><span class="pre">compute_derivatives</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dlt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#source.utilities.compute_derivatives" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the derivatives of a function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>(</em><em>N</em><em>, </em><em>) </em><em>ndarrays</em>) – The function whose derivatives to be computed.</p></li>
<li><p><strong>order</strong> (<em>int:</em>) – <p>1: first order derivative,</p>
<p>2: second order derivative.</p>
</p></li>
<li><p><strong>dlt</strong> (<em>float</em>) – Grid step.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>res</strong> – Deriative array.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(N, ) ndarrays</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>First order derivatives are computed one-sidedly.
Specifically,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{d f(x_0)}{dx} \approx &amp; \frac{f(x_1) - f(x_0)}{\Delta x} \\
\frac{d f(x_i)}{dx} \approx &amp; \frac{f(x_i) - f(x_{i-1})}{\Delta x}, i = 1,2,\dots,N\end{split}\]</div>
</dd></dl>
<dl class="py function">
<dt id="source.utilities.find_nearest_value">
<code class="sig-prename descclassname"><span class="pre">source.utilities.</span></code><code class="sig-name descname"><span class="pre">find_nearest_value</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#source.utilities.find_nearest_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of the element in <code class="docutils literal notranslate"><span class="pre">array</span></code> that is closest to <code class="docutils literal notranslate"><span class="pre">value</span></code>.</p>
</dd></dl>



          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="app/appendices.html" title="A. Complete model"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> A. Complete model </span>
              </div>
            </a>
          
          
            <a href="bib_file.html" title="References"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> References </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2021, SuriChen.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 3.5.3.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>